<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx/8.0.171"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="Controllers.events.RecruiterDashboardController"
            style="-fx-background-color:#EBF0F8;">

    <!-- TOP BAR -->
    <top>
        <VBox style="-fx-background-color:white; -fx-border-color:#E4EBF5;
                     -fx-border-width:0 0 1 0; -fx-padding:16 24 12 24;">
            <HBox alignment="CENTER_LEFT" spacing="14">
                <VBox spacing="3" HBox.hgrow="ALWAYS">
                    <Label text="Mes Evenements de Recrutement"
                           style="-fx-font-size:22px; -fx-font-weight:700; -fx-text-fill:#1E293B;"/>
                    <Label text="Gerez vos evenements, les inscriptions et consultez les avis"
                           style="-fx-font-size:12px; -fx-text-fill:#8FA3B8;"/>
                </VBox>
                <Button fx:id="tabEventsBtn" text="Mes evenements" onAction="#goToEvents"
                        style="-fx-background-color:#1565C0; -fx-text-fill:white; -fx-font-weight:700;
                               -fx-background-radius:8; -fx-padding:9 18;"/>
                <Button fx:id="tabSubscriptionsBtn" text="Inscriptions" onAction="#goToInterviews"
                        style="-fx-background-color:#F1F5F9; -fx-text-fill:#475569; -fx-font-weight:600;
                               -fx-background-radius:8; -fx-padding:9 18;
                               -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:8;"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <StackPane>

        <!-- â•â• VIEW 1: EVENTS (split-pane style) â•â• -->
        <VBox fx:id="eventsView" spacing="0" style="-fx-background-color:#EBF0F8;"
              maxWidth="Infinity" maxHeight="Infinity">

            <!-- Search bar -->
            <HBox spacing="10" alignment="CENTER_LEFT"
                  style="-fx-background-color:white; -fx-padding:10 24;
                         -fx-border-color:#E4EBF5; -fx-border-width:0 0 1 0;">
                <TextField fx:id="recruiterSearchField" promptText="Rechercher par titre..."
                           onKeyReleased="#handleRecruiterSearch" prefWidth="260"
                           style="-fx-background-radius:8; -fx-border-radius:8;
                                  -fx-border-color:#E4EBF5; -fx-border-width:1;
                                  -fx-padding:8 12; -fx-font-size:13px;"/>
                <ComboBox fx:id="recruiterTypeFilter" promptText="Tous les types"
                          onAction="#handleRecruiterSearch" prefWidth="170"
                          style="-fx-background-radius:8; -fx-border-color:#E4EBF5;
                                 -fx-border-width:1; -fx-border-radius:8; -fx-font-size:13px;"/>
                <Pane HBox.hgrow="ALWAYS"/>
                <Button text="+ Nouvel evenement" onAction="#handleNewEvent"
                        style="-fx-background-color:#1565C0; -fx-text-fill:white; -fx-font-weight:700;
                               -fx-background-radius:8; -fx-padding:9 18;"/>
            </HBox>

            <!-- Body: left list + right detail (draggable SplitPane) -->
            <SplitPane VBox.vgrow="ALWAYS" dividerPositions="0.38"
                       style="-fx-background-color:transparent; -fx-box-border:transparent; -fx-padding:0;">

                <!-- LEFT: event cards -->
                <ScrollPane fitToWidth="true"
                            style="-fx-background:transparent; -fx-background-color:#EBF0F8;
                                   -fx-border-color:transparent;">
                    <VBox spacing="0" style="-fx-background-color:#EBF0F8;">
                        <VBox fx:id="eventsListBox" spacing="10"
                              style="-fx-padding:14 10 14 14;"/>
                        <HBox alignment="CENTER" style="-fx-padding:6 14;">
                            <Label fx:id="eventsCountLabel" text="0 evenement(s)"
                                   style="-fx-font-size:11px; -fx-text-fill:#94A3B8;"/>
                        </HBox>
                    </VBox>
                </ScrollPane>

                <!-- RIGHT: detail + edit form + reviews -->
                <ScrollPane fitToWidth="true" HBox.hgrow="ALWAYS"
                            style="-fx-background:transparent; -fx-background-color:#EBF0F8;
                                   -fx-border-color:transparent;">
                    <VBox fx:id="rightPanel" spacing="16" style="-fx-padding:20 24; -fx-background-color:#EBF0F8;">

                        <!-- Placeholder -->
                        <VBox fx:id="rightPlaceholder" alignment="CENTER" spacing="14"
                              style="-fx-background-color:white; -fx-background-radius:14;
                                     -fx-border-color:#E8EEF8; -fx-border-width:1; -fx-border-radius:14;
                                     -fx-padding:60 40;
                                     -fx-effect:dropshadow(gaussian,rgba(91,163,245,0.09),12,0,0,3);">
                            <Label text="ðŸ“‹" style="-fx-font-size:40px;"/>
                            <Label text="Selectionnez un evenement"
                                   style="-fx-font-size:15px; -fx-font-weight:700; -fx-text-fill:#2c3e50;"/>
                            <Label text="Cliquez sur une carte pour voir les details et modifier l'evenement."
                                   style="-fx-font-size:12px; -fx-text-fill:#8FA3B8; -fx-text-alignment:center;"
                                   textAlignment="CENTER" wrapText="true"/>
                        </VBox>

                        <!-- Detail + edit (hidden until card clicked) -->
                        <VBox fx:id="rightDetail" managed="false" visible="false" spacing="14">

                            <!-- Info header card -->
                            <VBox spacing="8"
                                  style="-fx-background-color:white; -fx-background-radius:14;
                                         -fx-border-color:#E8EEF8; -fx-border-width:1; -fx-border-radius:14;
                                         -fx-padding:20 22;
                                         -fx-effect:dropshadow(gaussian,rgba(91,163,245,0.09),12,0,0,3);">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label fx:id="detailTypeBadge"
                                           style="-fx-background-color:#EBF3FF; -fx-text-fill:#1565C0;
                                                  -fx-font-size:11px; -fx-font-weight:700;
                                                  -fx-padding:3 10; -fx-background-radius:20;"/>
                                    <Label fx:id="detailPastBadge" text="PASSE"
                                           managed="false" visible="false"
                                           style="-fx-background-color:#F1F5F9; -fx-text-fill:#64748B;
                                                  -fx-font-size:11px; -fx-font-weight:700;
                                                  -fx-padding:3 10; -fx-background-radius:20;"/>
                                    <Pane HBox.hgrow="ALWAYS"/>
                                    <Label fx:id="detailDateLabel"
                                           style="-fx-font-size:12px; -fx-text-fill:#94A3B8;"/>
                                </HBox>
                                <Label fx:id="detailTitleLabel"
                                       style="-fx-font-size:18px; -fx-font-weight:800; -fx-text-fill:#1E293B;"
                                       wrapText="true"/>
                                <HBox spacing="18">
                                    <Label fx:id="detailLocationLabel"
                                           style="-fx-font-size:12px; -fx-text-fill:#475569;"/>
                                    <Label fx:id="detailCapacityLabel"
                                           style="-fx-font-size:12px; -fx-text-fill:#475569;"/>
                                </HBox>
                                <Label fx:id="detailDescLabel"
                                       style="-fx-font-size:13px; -fx-text-fill:#64748B; -fx-line-spacing:3;"
                                       wrapText="true"/>
                            </VBox>

                            <!-- Edit / Delete form -->
                            <VBox spacing="12"
                                  style="-fx-background-color:white; -fx-background-radius:14;
                                         -fx-border-color:#E8EEF8; -fx-border-width:1; -fx-border-radius:14;
                                         -fx-padding:20 22;
                                         -fx-effect:dropshadow(gaussian,rgba(91,163,245,0.09),12,0,0,3);">
                                <Label text="Modifier cet evenement"
                                       style="-fx-font-size:14px; -fx-font-weight:700; -fx-text-fill:#1E293B;"/>
                                <HBox spacing="10">
                                    <VBox HBox.hgrow="ALWAYS" spacing="3">
                                        <TextField fx:id="titleField" promptText="Titre"
                                                   style="-fx-background-radius:8; -fx-border-radius:8;
                                                          -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                          -fx-padding:8 12; -fx-font-size:13px;"/>
                                        <Label fx:id="titleErrorLabel"
                                               style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                    </VBox>
                                    <VBox spacing="3">
                                        <ComboBox fx:id="typeCombo" prefWidth="160" promptText="Type"
                                                  style="-fx-background-radius:8; -fx-border-radius:8;
                                                         -fx-border-color:#E4EBF5; -fx-font-size:13px;"/>
                                        <Label fx:id="typeErrorLabel"
                                               style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                    </VBox>
                                </HBox>
                                <HBox spacing="10">
                                    <VBox HBox.hgrow="ALWAYS" spacing="3">
                                        <HBox spacing="5" alignment="CENTER_LEFT">
                                            <TextField fx:id="locationField" promptText="Lieu"
                                                       HBox.hgrow="ALWAYS"
                                                       style="-fx-background-radius:8; -fx-border-radius:8;
                                                              -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                              -fx-padding:8 12; -fx-font-size:13px;"/>
                                            <Button text="Carte" onAction="#handlePickLocation"
                                                    style="-fx-background-color:#2196F3; -fx-text-fill:white;
                                                           -fx-padding:7 12; -fx-background-radius:6;"/>
                                        </HBox>
                                        <Label fx:id="locationErrorLabel"
                                               style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                    </VBox>
                                    <VBox spacing="3">
                                        <DatePicker fx:id="dateField" promptText="Date"
                                                    onAction="#handleDateValidation"
                                                    style="-fx-background-radius:8; -fx-border-color:#E4EBF5;
                                                           -fx-font-size:13px;"/>
                                        <Label fx:id="dateErrorLabel"
                                               style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                    </VBox>
                                    <VBox spacing="3">
                                        <TextField fx:id="capacityField" prefWidth="100" promptText="Capacite"
                                                   style="-fx-background-radius:8; -fx-border-radius:8;
                                                          -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                          -fx-padding:8 12; -fx-font-size:13px;"/>
                                        <Label fx:id="capacityErrorLabel"
                                               style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                    </VBox>
                                </HBox>
                                <VBox spacing="3">
                                    <TextField fx:id="meetLinkField"
                                               promptText="Lien reunion (https://meet.google.com/...)"
                                               visible="false" managed="false"
                                               style="-fx-background-radius:8; -fx-border-radius:8;
                                                      -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                      -fx-padding:8 12; -fx-font-size:13px;"/>
                                    <Label fx:id="meetLinkErrorLabel" managed="false" visible="false"
                                           style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                </VBox>
                                <VBox spacing="4">
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Label text="Description"
                                               style="-fx-font-size:13px; -fx-font-weight:600; -fx-text-fill:#334155;"/>
                                        <Pane HBox.hgrow="ALWAYS"/>
                                        <Button text="IA" onAction="#handleGenerateDescriptionAI"
                                                style="-fx-background-color:#6f42c1; -fx-text-fill:white;
                                                       -fx-font-size:11px; -fx-padding:6 12; -fx-background-radius:6;"/>
                                    </HBox>
                                    <TextArea fx:id="descriptionField" prefHeight="90"
                                              promptText="Description..." wrapText="true"
                                              style="-fx-background-radius:8; -fx-border-radius:8;
                                                     -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                     -fx-font-size:13px; -fx-padding:8 12;"/>
                                    <Label fx:id="descriptionErrorLabel"
                                           style="-fx-font-size:11px; -fx-text-fill:#DC2626;" minHeight="0"/>
                                </VBox>
                                <HBox spacing="10" alignment="CENTER_RIGHT">
                                    <Button onAction="#handleClear" text="Vider"
                                            style="-fx-background-color:#F1F5F9; -fx-text-fill:#475569;
                                                   -fx-background-radius:8; -fx-padding:8 16;"/>
                                    <Pane HBox.hgrow="ALWAYS"/>
                                    <Button onAction="#handleDelete" text="Supprimer"
                                            style="-fx-background-color:#FEF2F2; -fx-text-fill:#DC2626;
                                                   -fx-font-weight:600; -fx-background-radius:8;
                                                   -fx-border-color:#FECACA; -fx-border-width:1;
                                                   -fx-border-radius:8; -fx-padding:8 16;"/>
                                    <Button onAction="#handleUpdate" text="Enregistrer"
                                            style="-fx-background-color:#1565C0; -fx-text-fill:white;
                                                   -fx-font-weight:700; -fx-background-radius:8; -fx-padding:8 20;"/>
                                </HBox>
                            </VBox>

                            <!-- REVIEWS PANEL â€” only past events -->
                            <VBox fx:id="reviewsPanelInDetail" spacing="12"
                                  managed="false" visible="false"
                                  style="-fx-background-color:white; -fx-background-radius:14;
                                         -fx-border-color:#FDE68A; -fx-border-width:2; -fx-border-radius:14;
                                         -fx-padding:20 22;
                                         -fx-effect:dropshadow(gaussian,rgba(91,163,245,0.09),12,0,0,3);">
                                <HBox alignment="CENTER_LEFT" spacing="16">
                                    <VBox spacing="2" alignment="CENTER">
                                        <Label fx:id="reviewsAvgScore" text="â€”"
                                               style="-fx-font-size:36px; -fx-font-weight:800; -fx-text-fill:#D97706;"/>
                                        <Label text="/ 5" style="-fx-font-size:12px; -fx-text-fill:#92400E;"/>
                                    </VBox>
                                    <VBox spacing="4" HBox.hgrow="ALWAYS">
                                        <Label text="Avis des participants"
                                               style="-fx-font-size:15px; -fx-font-weight:700; -fx-text-fill:#1E293B;"/>
                                        <Label fx:id="reviewsStarsLabel" text=""
                                               style="-fx-font-size:20px; -fx-text-fill:#F59E0B;"/>
                                        <Label fx:id="reviewsTotalLabel" text="Aucun avis"
                                               style="-fx-font-size:12px; -fx-text-fill:#64748B;"/>
                                    </VBox>
                                </HBox>
                                <VBox fx:id="reviewsCardsBox" spacing="8"/>
                                <Label fx:id="reviewsEmptyLabel" text="Aucun avis pour cet evenement."
                                       managed="false" visible="false"
                                       style="-fx-font-size:13px; -fx-text-fill:#94A3B8; -fx-padding:8 0;"/>
                            </VBox>

                        </VBox>

                        <!-- New event form (shown by + button) -->
                        <VBox fx:id="newEventForm" managed="false" visible="false" spacing="12"
                              style="-fx-background-color:white; -fx-background-radius:14;
                                     -fx-border-color:#E8EEF8; -fx-border-width:1; -fx-border-radius:14;
                                     -fx-padding:20 22;
                                     -fx-effect:dropshadow(gaussian,rgba(91,163,245,0.09),12,0,0,3);">
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="Creer un nouvel evenement"
                                       style="-fx-font-size:15px; -fx-font-weight:700; -fx-text-fill:#1E293B;"
                                       HBox.hgrow="ALWAYS"/>
                                <Button text="Annuler" onAction="#handleCancelNewEvent"
                                        style="-fx-background-color:#F1F5F9; -fx-text-fill:#475569;
                                               -fx-background-radius:8; -fx-padding:7 14;"/>
                            </HBox>
                            <!-- Title + Type row -->
                            <HBox spacing="10">
                                <VBox HBox.hgrow="ALWAYS" spacing="3">
                                    <TextField fx:id="newTitleField" promptText="Titre"
                                               style="-fx-background-radius:8; -fx-border-radius:8;
                                                      -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                      -fx-padding:8 12; -fx-font-size:13px;"/>
                                </VBox>
                                <VBox spacing="3">
                                    <ComboBox fx:id="newTypeCombo" prefWidth="160" promptText="Type"
                                              style="-fx-background-radius:8; -fx-border-radius:8;
                                                     -fx-border-color:#E4EBF5; -fx-font-size:13px;"/>
                                </VBox>
                            </HBox>
                            <!-- Location (with map button) + Date + Capacity -->
                            <HBox spacing="10">
                                <HBox HBox.hgrow="ALWAYS" spacing="5" alignment="CENTER_LEFT">
                                    <TextField fx:id="newLocationField" promptText="Lieu" HBox.hgrow="ALWAYS"
                                               style="-fx-background-radius:8; -fx-border-radius:8;
                                                      -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                      -fx-padding:8 12; -fx-font-size:13px;"/>
                                    <Button text="ðŸ—º Carte" onAction="#handlePickLocationNew"
                                            style="-fx-background-color:#2196F3; -fx-text-fill:white;
                                                   -fx-padding:7 12; -fx-background-radius:6;
                                                   -fx-font-size:12px; -fx-cursor:hand;"/>
                                </HBox>
                                <DatePicker fx:id="newDateField" promptText="Date"
                                            style="-fx-background-radius:8; -fx-border-color:#E4EBF5; -fx-font-size:13px;"/>
                                <TextField fx:id="newCapacityField" prefWidth="100" promptText="Capacite"
                                           style="-fx-background-radius:8; -fx-border-radius:8;
                                                  -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                  -fx-padding:8 12; -fx-font-size:13px;"/>
                            </HBox>
                            <!-- Description with AI button -->
                            <VBox spacing="4">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Label text="Description"
                                           style="-fx-font-size:13px; -fx-font-weight:600; -fx-text-fill:#334155;"
                                           HBox.hgrow="ALWAYS"/>
                                    <Button text="âœ¨ IA" onAction="#handleGenerateDescriptionAINew"
                                            style="-fx-background-color:#6f42c1; -fx-text-fill:white;
                                                   -fx-font-size:11px; -fx-padding:6 12; -fx-background-radius:6;
                                                   -fx-cursor:hand;"/>
                                </HBox>
                                <TextArea fx:id="newDescriptionField" prefHeight="90" promptText="Description..."
                                          wrapText="true"
                                          style="-fx-background-radius:8; -fx-border-radius:8;
                                                 -fx-border-color:#E4EBF5; -fx-border-width:1;
                                                 -fx-font-size:13px; -fx-padding:8 12;"/>
                            </VBox>
                            <Label fx:id="newFormErrorLabel" managed="false" visible="false"
                                   style="-fx-font-size:11px; -fx-text-fill:#DC2626;"/>
                            <HBox alignment="CENTER_RIGHT">
                                <Button onAction="#handleAddNew" text="Ajouter l'evenement"
                                        style="-fx-background-color:#1565C0; -fx-text-fill:white;
                                               -fx-font-weight:700; -fx-background-radius:8; -fx-padding:10 24;"/>
                            </HBox>
                        </VBox>

                    </VBox>
                </ScrollPane>
            </SplitPane>
        </VBox>

        <!-- â•â• VIEW 2: SUBSCRIPTIONS / ATTENDEES â•â• -->
        <VBox fx:id="interviewsView" spacing="14" visible="false" managed="false"
              maxWidth="Infinity" maxHeight="Infinity"
              style="-fx-background-color:#EBF0F8; -fx-padding:20 24;">

            <HBox alignment="CENTER_LEFT" spacing="12">
                <VBox spacing="2" HBox.hgrow="ALWAYS">
                    <Label text="Candidats inscrits"
                           style="-fx-font-size:22px; -fx-font-weight:700; -fx-text-fill:#1E293B;"/>
                    <Label text="Gerez les inscriptions et les statuts de presence"
                           style="-fx-font-size:12px; -fx-text-fill:#64748B;"/>
                </VBox>
                <Button text="Actualiser" onAction="#goToInterviews"
                        style="-fx-background-color:#EBF3FF; -fx-text-fill:#1565C0; -fx-font-weight:600;
                               -fx-background-radius:8; -fx-padding:8 16;
                               -fx-border-color:#BBDEFB; -fx-border-width:1; -fx-border-radius:8;"/>
            </HBox>

            <!-- Stats -->
            <HBox fx:id="statsContainer" spacing="10">
                <VBox HBox.hgrow="ALWAYS" spacing="4"
                      style="-fx-background-color:white; -fx-background-radius:12;
                             -fx-border-color:#BBDEFB; -fx-border-width:2; -fx-border-radius:12; -fx-padding:12 14;">
                    <Label fx:id="totalStatsLabel" text="0"
                           style="-fx-font-size:24px; -fx-font-weight:800; -fx-text-fill:#1565C0;"/>
                    <Label text="Total" style="-fx-font-size:11px; -fx-text-fill:#64748B;"/>
                </VBox>
                <VBox HBox.hgrow="ALWAYS" spacing="4"
                      style="-fx-background-color:white; -fx-background-radius:12;
                             -fx-border-color:#FFE082; -fx-border-width:2; -fx-border-radius:12; -fx-padding:12 14;">
                    <Label fx:id="pendingStatsLabel" text="0"
                           style="-fx-font-size:24px; -fx-font-weight:800; -fx-text-fill:#FF8F00;"/>
                    <Label text="En attente" style="-fx-font-size:11px; -fx-text-fill:#64748B;"/>
                </VBox>
                <VBox HBox.hgrow="ALWAYS" spacing="4"
                      style="-fx-background-color:white; -fx-background-radius:12;
                             -fx-border-color:#A5D6A7; -fx-border-width:2; -fx-border-radius:12; -fx-padding:12 14;">
                    <Label fx:id="confirmedStatsLabel" text="0"
                           style="-fx-font-size:24px; -fx-font-weight:800; -fx-text-fill:#2E7D32;"/>
                    <Label text="Confirmes" style="-fx-font-size:11px; -fx-text-fill:#64748B;"/>
                </VBox>
                <VBox HBox.hgrow="ALWAYS" spacing="4"
                      style="-fx-background-color:white; -fx-background-radius:12;
                             -fx-border-color:#FDBA74; -fx-border-width:2; -fx-border-radius:12; -fx-padding:12 14;">
                    <Label fx:id="rejectedStatsLabel" text="0"
                           style="-fx-font-size:24px; -fx-font-weight:800; -fx-text-fill:#C2410C;"/>
                    <Label text="Rejetes" style="-fx-font-size:11px; -fx-text-fill:#64748B;"/>
                </VBox>
                <VBox HBox.hgrow="ALWAYS" spacing="4"
                      style="-fx-background-color:white; -fx-background-radius:12;
                             -fx-border-color:#CBD5E1; -fx-border-width:2; -fx-border-radius:12; -fx-padding:12 14;">
                    <Label fx:id="cancelledStatsLabel" text="0"
                           style="-fx-font-size:24px; -fx-font-weight:800; -fx-text-fill:#64748B;"/>
                    <Label text="Annules" style="-fx-font-size:11px; -fx-text-fill:#64748B;"/>
                </VBox>
            </HBox>

            <!-- Filter toolbar -->
            <HBox spacing="8" alignment="CENTER_LEFT"
                  style="-fx-background-color:white; -fx-background-radius:10;
                         -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:10; -fx-padding:10 14;">
                <TextField fx:id="attendeesSearchField" promptText="Rechercher..."
                           onKeyReleased="#handleAttendeesSearch" HBox.hgrow="ALWAYS"
                           style="-fx-background-color:#F8FAFF; -fx-background-radius:8;
                                  -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:8;
                                  -fx-padding:8 12; -fx-font-size:13px;"/>
                <ComboBox fx:id="attendeesEventFilter" promptText="Tous les evenements"
                          onAction="#handleAttendeesSearch" prefWidth="185"
                          style="-fx-background-color:#F8FAFF; -fx-background-radius:8;
                                 -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:8; -fx-font-size:13px;"/>
                <ComboBox fx:id="attendeesStatusFilter" promptText="Tous les statuts"
                          onAction="#handleAttendeesSearch" prefWidth="155"
                          style="-fx-background-color:#F8FAFF; -fx-background-radius:8;
                                 -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:8; -fx-font-size:13px;"/>
                <ComboBox fx:id="attendeesSortCombo" promptText="Trier par..."
                          onAction="#handleAttendeesSearch" prefWidth="148"
                          style="-fx-background-color:#F8FAFF; -fx-background-radius:8;
                                 -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:8; -fx-font-size:13px;"/>
                <Button text="Reinitialiser" onAction="#handleAttendeesReset"
                        style="-fx-background-color:#FEF2F2; -fx-text-fill:#DC2626; -fx-font-weight:600;
                               -fx-background-radius:8; -fx-padding:8 12;
                               -fx-border-color:#FECACA; -fx-border-width:1; -fx-border-radius:8;"/>
            </HBox>

            <!-- Table -->
            <VBox VBox.vgrow="ALWAYS" spacing="0"
                  style="-fx-background-color:white; -fx-background-radius:12;
                         -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:12;">
                <HBox alignment="CENTER_LEFT" spacing="8"
                      style="-fx-background-color:#F8FAFF; -fx-background-radius:12 12 0 0;
                             -fx-border-color:#E4EBF5; -fx-border-width:0 0 1 0; -fx-padding:10 16;">
                    <Label text="Liste des inscriptions"
                           style="-fx-font-size:14px; -fx-font-weight:700; -fx-text-fill:#1E293B;"/>
                    <Pane HBox.hgrow="ALWAYS"/>
                    <Label fx:id="attendeesCountLabel" text="0 resultat(s)"
                           style="-fx-font-size:12px; -fx-text-fill:#1565C0;
                                  -fx-background-color:#EBF3FF; -fx-background-radius:20; -fx-padding:3 10;"/>
                </HBox>
                <TableView fx:id="attendeesTable" VBox.vgrow="ALWAYS"
                           style="-fx-background-color:transparent; -fx-border-color:transparent;">
                    <columns>
                        <TableColumn fx:id="eventTitleCol"    prefWidth="160" text="Evenement"/>
                        <TableColumn fx:id="candLastNameCol"  prefWidth="120" text="Nom"/>
                        <TableColumn fx:id="candFirstNameCol" prefWidth="120" text="Prenom"/>
                        <TableColumn fx:id="candEmailCol"     prefWidth="200" text="Email"/>
                        <TableColumn fx:id="statusCol"        prefWidth="130" text="Statut"/>
                        <TableColumn fx:id="regDateCol"       prefWidth="160" text="Date inscription"/>
                    </columns>
                    <placeholder>
                        <Label text="Aucune inscription trouvee"
                               style="-fx-font-size:14px; -fx-text-fill:#8FA3B8;"/>
                    </placeholder>
                </TableView>
            </VBox>

            <!-- Action bar -->
            <HBox alignment="CENTER_LEFT" spacing="12"
                  style="-fx-background-color:white; -fx-background-radius:10;
                         -fx-border-color:#E4EBF5; -fx-border-width:1; -fx-border-radius:10; -fx-padding:12 18;">
                <Label text="Action:" style="-fx-font-size:13px; -fx-font-weight:700; -fx-text-fill:#334155;"/>
                <Button fx:id="acceptBtn" onAction="#handleAcceptRegistration" text="Accepter"
                        style="-fx-background-color:#16A34A; -fx-text-fill:white; -fx-font-weight:700;
                               -fx-background-radius:8; -fx-padding:9 22;"/>
                <Button fx:id="rejectBtn" onAction="#handleRejectRegistration" text="Refuser"
                        style="-fx-background-color:#C2410C; -fx-text-fill:white; -fx-font-weight:700;
                               -fx-background-radius:8; -fx-padding:9 22;"/>
                <Pane HBox.hgrow="ALWAYS"/>
                <Label text="Annule par le candidat = aucune action possible."
                       style="-fx-font-size:11px; -fx-text-fill:#94A3B8;"/>
            </HBox>

        </VBox>

        </StackPane>
    </center>
</BorderPane>
