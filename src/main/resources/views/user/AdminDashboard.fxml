<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.layout.Region?>

<ScrollPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="Controllers.user.AdminDashboardController"
            fitToWidth="true"
            style="-fx-background-color: #f8f9fa;">

    <VBox spacing="20"
          styleClass="page"
          stylesheets="@../../styles.css"
          style="-fx-background-color: #f8f9fa;">

        <padding>
            <Insets top="25" left="25" right="25" bottom="25"/>
        </padding>

        <!-- Header Section -->
        <HBox alignment="CENTER_LEFT" spacing="20">
            <VBox spacing="5" HBox.hgrow="ALWAYS">
                <Label text="Admin Dashboard" styleClass="page-title"/>
                <Label text="Manage users, roles, and system statistics" styleClass="page-subtitle"/>
            </VBox>
        </HBox>

        <!-- Statistics Cards Section -->
        <HBox spacing="15" VBox.vgrow="NEVER">

            <!-- Total Users Card -->
            <VBox spacing="8"
                  style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);"
                  HBox.hgrow="ALWAYS">
                <Label text="Total Users" style="-fx-text-fill: #6c757d; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                <Label fx:id="lblTotalUsers" text="0" style="-fx-text-fill: #5BA3F5; -fx-font-size: 32px; -fx-font-weight: bold;"/>
            </VBox>

            <!-- Recruiters Card -->
            <VBox spacing="8"
                  style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);"
                  HBox.hgrow="ALWAYS">
                <Label text="Recruiters" style="-fx-text-fill: #6c757d; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                <Label fx:id="lblRecruiters" text="0" style="-fx-text-fill: #17a2b8; -fx-font-size: 32px; -fx-font-weight: bold;"/>
            </VBox>

            <!-- Candidates Card -->
            <VBox spacing="8"
                  style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);"
                  HBox.hgrow="ALWAYS">
                <Label text="Candidates" style="-fx-text-fill: #6c757d; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                <Label fx:id="lblCandidates" text="0" style="-fx-text-fill: #28a745; -fx-font-size: 32px; -fx-font-weight: bold;"/>
            </VBox>

            <!-- Admins Card -->
            <VBox spacing="8"
                  style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);"
                  HBox.hgrow="ALWAYS">
                <Label text="Admins" style="-fx-text-fill: #6c757d; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                <Label fx:id="lblAdmins" text="0" style="-fx-text-fill: #ffc107; -fx-font-size: 32px; -fx-font-weight: bold;"/>
            </VBox>

        </HBox>

        <!-- Charts Section -->
        <HBox spacing="15" VBox.vgrow="ALWAYS">

            <!-- Pie Chart: User Distribution -->
            <VBox spacing="10"
                  style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);"
                  HBox.hgrow="ALWAYS">
                <Label text="User Distribution by Role" style="-fx-text-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                <PieChart fx:id="pieChart" VBox.vgrow="ALWAYS" animated="true" style="-fx-font-size: 11px;"/>
            </VBox>

            <!-- Bar Chart: User Status -->
            <VBox spacing="10"
                  style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);"
                  HBox.hgrow="ALWAYS">
                <Label text="Active vs Inactive Users" style="-fx-text-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                <BarChart fx:id="barChart" VBox.vgrow="ALWAYS" animated="true" style="-fx-font-size: 11px;">
                    <xAxis>
                        <CategoryAxis side="BOTTOM"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis side="LEFT" autoRanging="true"/>
                    </yAxis>
                </BarChart>
            </VBox>

        </HBox>

        <!-- User Management Section -->
        <VBox spacing="12"
              VBox.vgrow="ALWAYS"
              style="-fx-border-color: #e9ecef; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-color: #ffffff; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 1);">

            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="20">
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="User Management" style="-fx-text-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                    <Label fx:id="lblRecordCount" text="Records: 0" style="-fx-text-fill: #6c757d; -fx-font-size: 11px;"/>
                </VBox>

                <Button fx:id="btnAddUser"
                        text="Add Admin"
                        onAction="#handleAddUser" />            </HBox>

            <!-- Search and Filter Bar -->
            <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-padding: 10 0 0 0;">
                <TextField fx:id="searchField"
                           promptText="Search by name or email..."
                           HBox.hgrow="ALWAYS"
                           style="-fx-border-color: #ddd; -fx-border-radius: 4; -fx-padding: 8px;"/>

                <ComboBox fx:id="roleFilter" promptText="Filter by role" style="-fx-min-width: 150;"/>

                <Button fx:id="btnSearch" text="ðŸ” Search" styleClass="btn-secondary" onAction="#handleSearch"/>
                <Button fx:id="btnRefresh" text="ðŸ”„ Refresh" styleClass="btn-secondary" onAction="#handleRefresh"/>
            </HBox>

            <!-- Filter Tabs -->
            <HBox spacing="8" style="-fx-padding: 10 0 0 0;">
                <Button fx:id="btnAllUsers" text="All Users" styleClass="btn-outline" onAction="#handleShowAll"/>
                <Button fx:id="btnRecruiters" text="Recruiters" styleClass="btn-outline" onAction="#handleShowRecruiters"/>
                <Button fx:id="btnCandidates" text="Candidates" styleClass="btn-outline" onAction="#handleShowCandidates"/>
                <Button fx:id="btnAdmins" text="Admins" styleClass="btn-outline" onAction="#handleShowAdmins"/>
            </HBox>

            <!-- User Table -->
            <TableView fx:id="userTable" VBox.vgrow="ALWAYS" style="-fx-font-size: 12px;">
                <columns>
                    <TableColumn fx:id="colName" text="Name" prefWidth="180"/>
                    <TableColumn fx:id="colEmail" text="Email" prefWidth="200"/>
                    <TableColumn fx:id="colRole" text="Role" prefWidth="120"/>
                    <TableColumn fx:id="colPhone" text="Phone" prefWidth="140"/>
                    <TableColumn fx:id="colActive" text="Status" prefWidth="100"/>
                </columns>
            </TableView>

            <!-- Action Buttons -->
            <HBox spacing="10" style="-fx-padding: 10 0 0 0;">
                <Button fx:id="btnEdit" text="âœï¸ Edit" styleClass="btn-primary" disable="true" onAction="#handleEdit"/>
                <Button fx:id="btnDelete" text="ðŸ—‘ï¸ Delete" styleClass="btn-danger" disable="true" onAction="#handleDelete"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="statusLabel" text="" style="-fx-text-fill: #28a745; -fx-font-size: 11px; -fx-font-weight: 500;"/>
            </HBox>

        </VBox>

    </VBox>
</ScrollPane>
